# ScheduleToContact

Googleカレンダーの予定から、スプレッドシートで定義したルールに基づいて連絡用のテキストを生成するGoogle Apps Scriptです。Webアプリとしても利用可能です。

## 主な機能

- カレンダーの予定とスプレッドシートのルールに基づいてテキストを生成
- 生成したテキストを「行動」ごとにグループ化
- 必須の予定が見つからない場合に警告を表示
- 出力する文言のマッピング機能
- **Webアプリとして利用可能**
- **Webアプリ上で生成結果の編集、クリップボードへのコピーが可能**
- **Webアプリのデバッグ情報（取得した予定一覧）をテーブル形式で表示し、視認性を向上**
- **モバイルフレンドリーなレスポンシブデザイン**

## セットアップ

1.  `git clone`でこのリポジリをクローンします。
2.  `pnpm install`で依存関係をインストールします。
3.  Google Apps Scriptプロジェクトを新規作成し、`scriptId`を取得します。
4.  `.clasp.json.example`をコピーして`.clasp.json`を作成し、取得した`scriptId`を記述します。
5.  Apps Scriptのプロジェクト設定で、スクリプトプロパティに`CALENDAR_ID`（対象のカレンダーID）を設定します。
6.  スプレッドシートに「ルール設定」シートを作成し、以下の構成でルールを定義します。

| A列 | B列 | C列 | D列 |
| :--- | :--- | :--- | :--- |
| キーワード | 出力ワード | 行動 | 必須（チェックボックス） |

## 使い方

### スプレッドシートから利用する場合

スプレッドシートのカスタムメニューから「連絡テキスト生成 (今月分)」を実行します。

### Webアプリとして利用する場合

1.  `pnpm run deploy`を実行し、コードをGoogle Apps Scriptにプッシュします。
2.  Google Apps Scriptのエディタで「デプロイ」->「新しいデプロイ」を選択し、「ウェブアプリ」としてデプロイします。
3.  発行されたWebアプリのURLにアクセスし、ボタンをクリックしてテキストを生成します。

## ライセンス

[ISC](LICENSE)