# ScheduleToContact

Googleカレンダーの予定から、スプレッドシートで定義したルールに基づいて連絡用のテキストを生成するGoogle Apps Scriptです。Webアプリとしても利用可能です。

## 主な機能

- カレンダーの予定とスプレッドシートのルールに基づいてテキストを生成
- 生成したテキストを「行動」ごとにグループ化
- 必須の予定が見つからない場合に警告を表示
- 出力する文言のマッピング機能
- **Webアプリとして利用可能**
- **Webアプリ上で生成結果の編集、クリップボードへのコピーが可能**
- **Webアプリのデバッグ情報（取得した予定一覧）をテーブル形式で表示し、視認性を向上**
- **モバイルフレンドリーなレスポンシブデザイン**

## セットアップ

1.  **リポジトリのクローンと依存関係のインストール**
    ```bash
    git clone https://github.com/your-username/your-repo-name.git
    cd your-repo-name
    pnpm install
    ```
2.  **Google Apps Scriptプロジェクトのセットアップ**
    - Google Apps Scriptで新しいプロジェクトを作成します。
    - `.clasp.json.example`を`.clasp.json`にコピーし、`scriptId`を新しいプロジェクトのものに書き換えます。
3.  **環境変数の設定**
    - `.env.example`を`.env`にコピーします。
    - `.env`ファイルを開き、`CALENDAR_ID`（予定を読み込むGoogleカレンダーのID）を設定します。
    - `GAS_DEPLOYMENT_ID`は、初回のWebアプリデプロイ後に設定します（後述）。
4.  **スプレッドシートの準備**
    スプレッドシートに「ルール設定」シートを作成し、以下の構成でルールを定義します。

| A列 | B列 | C列 | D列 |
| :--- | :--- | :--- | :--- |
| キーワード | 出力ワード | 行動 | 必須（チェックボックス） |

## 使い方

### スプレッドシートから利用する場合

スプレッドシートのカスタムメニューから「連絡テキスト生成 (今月分)」を実行します。

### Webアプリとして利用する場合

1.  **初回デプロイ**
    - Google Apps ScriptのWebエディタを開きます。
    - 「デプロイ」 > 「新しいデプロイ」を選択します。
    - 種類として「ウェブアプリ」を選択し、アクセスできるユーザーを設定して「デプロイ」ボタンを押します。
    - 表示された**デプロイID**をコピーし、`.env`ファイルの`GAS_DEPLOYMENT_ID`に設定します。
2.  **2回目以降のデプロイ**
    変更をデプロイするには、ローカルで以下のコマンドを実行するだけです。ビルドからWebアプリの更新までが自動的に行われます。
    ```bash
    pnpm run deploy
    ```
3.  **Webアプリへのアクセス**
    デプロイ管理画面に表示されているURLにアクセスし、ボタンをクリックしてテキストを生成します。

## ライセンス

[ISC](LICENSE)